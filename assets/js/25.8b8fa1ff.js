(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{268:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#密码"}},[s._v("#")]),s._v(" 密码")]),s._v(" "),a("h2",{attrs:{id:"查询用户密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询用户密码"}},[s._v("#")]),s._v(" 查询用户密码")]),s._v(" "),a("p",[s._v("查询用户密码命令：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("  host,  user,  authentication_string  from  mysql.user "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("ul",[a("li",[a("p",[a("code",[s._v("host")]),s._v("：允许用户登录的"),a("code",[s._v("ip")]),s._v(" '位置'%表示可以远程；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("user")]),s._v("：当前数据库的用户名；")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("authentication_string")]),s._v("：用户密码（后面有提到此字段）；")])])]),s._v(" "),a("h2",{attrs:{id:"设置密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置密码"}},[s._v("#")]),s._v(" 设置密码")]),s._v(" "),a("p",[s._v("默认 "),a("code",[s._v("root")]),s._v(" 密码为空的话 ，下面使用 "),a("code",[s._v("navicat")]),s._v(" 就无法连接 ，所以这里需要修改 "),a("code",[s._v("root")]),s._v(" 的密码。")]),s._v(" "),a("p",[s._v("此乃关键一步。为此我被坑了好长时间（所以才有了这篇文章），后来尝试了很多才知道在 "),a("code",[s._v("mysql 5.7.9")]),s._v(" 以后废弃了 "),a("code",[s._v("password")]),s._v(" 字段和 "),a("code",[s._v("password()")]),s._v(" 函数；")]),s._v(" "),a("p",[a("code",[s._v("authentication_string")]),s._v("：字段表示用户密码。")]),s._v(" "),a("h3",{attrs:{id:"操作步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作步骤"}},[s._v("#")]),s._v(" 操作步骤")]),s._v(" "),a("ul",[a("li",[s._v("1.如果当前 "),a("code",[s._v("root")]),s._v(" 用户 "),a("code",[s._v("authentication_string")]),s._v(" 字段下有内容，可先将其设置为空，不然直接进行二步骤。")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 密码设置为空")]),s._v("\nupdate user "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("authentication_string")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v(" where "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("ul",[a("li",[s._v("2.使用 "),a("code",[s._v("ALTER")]),s._v(" 修改 "),a("code",[s._v("root")]),s._v(" 用户密码, 方法为 "),a("code",[s._v("ALTER user 'root'@'localhost' IDENTIFIED BY '新密码'")]),s._v(" 。如下：")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ALTER "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" IDENTIFIED BY "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mypwd#2019'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("也可输入：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ALTER "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" IDENTIFIED WITH mysql_native_password BY "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mypwd#2019'")]),s._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[a("code",[s._v("root@")]),s._v(" 后面是 "),a("code",[s._v("user")]),s._v(" 表的 "),a("code",[s._v("Host")]),s._v(" 字段的内容，新安装默认是 "),a("code",[s._v("localhost")]),s._v(" , 因为在这增加了远程访问，所以将 "),a("code",[s._v("localhost")]),s._v(" 手动改成了 "),a("code",[s._v("%")]),s._v("。")])]),s._v(" "),a("p",[s._v("改完之后可执行："),a("code",[s._v("flush privileges;")]),s._v(" （ 重新加载权限表 ）")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("flush privileges"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[a("strong",[s._v("注意："),a("code",[s._v("mysql8.0")]),s._v(" 之后的版本，下面方法已经不适用。切记！！！")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("UPDATE user SET "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("PASSWORD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"新密码"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" WHERE "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'用户名'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"node-js-连接-mysql-密码问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-js-连接-mysql-密码问题"}},[s._v("#")]),s._v(" Node.js 连接 Mysql 密码问题")]),s._v(" "),a("p",[s._v("昨天我通过 "),a("code",[s._v("Node.js")]),s._v(" 中 "),a("code",[s._v("mysql")]),s._v(" 模块连接数据时，控制台一直报错，起初我以为是我代码逻辑有问题，最终定位到只要数据库连接就会报一下错误信息：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Error: ER_NOT_SUPPORTED_AUTH_MODE: Client does not support authentication protocol requested by server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" consider upgrading MySQL client\n    at Handshake.Sequence._packetToError "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("D:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("workspaceGithub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("nodejs-book-samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql-demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("node_modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("protocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("sequences"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Sequence.js:47:14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Handshake.ErrorPacket "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("D:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("workspaceGithub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("nodejs-book-samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql-demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("node_modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("protocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("sequences"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Handshake.js:123:18"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Protocol._parsePacket "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("D:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("workspaceGithub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("nodejs-book-samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql-demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("node_modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("protocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Protocol.js:291:23"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Parser._parsePacket "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("D:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("workspaceGithub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("nodejs-book-samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql-demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("node_modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("protocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Parser.js:433:10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Parser.write "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("D:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("workspaceGithub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("nodejs-book-samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql-demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("node_modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("protocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Parser.js:43:10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Protocol.write "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("D:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("workspaceGithub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("nodejs-book-samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql-demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("node_modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("protocol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Protocol.js:38:16"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Socket."),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("anonymous"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("D:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("workspaceGithub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("nodejs-book-samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql-demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("node_modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Connection.js:91:28"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Socket."),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("anonymous"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("D:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("workspaceGithub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("nodejs-book-samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("samples"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql-demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("node_modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Connection.js:525:10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Socket.emit "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("events.js:196:13"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at addChunk "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_stream_readable.js:290:12"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    --------------------\n\n")])])]),a("p",[s._v("问题描述在这里 "),a("code",[s._v("Client does not support authentication protocol requested by server; consider upgrading MySQL client at Handshake.Sequence._packetToError")]),s._v("，说我的 "),a("code",[s._v("mysql")]),s._v(" 客户端版本不支持用户身份验证，但是我安装的客户端是目前比较新的版本，按理说不会不支持呀，带着问题我向度娘寻找答案。")]),s._v(" "),a("h3",{attrs:{id:"出错原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#出错原因"}},[s._v("#")]),s._v(" 出错原因")]),s._v(" "),a("p",[s._v("原来，最新的 "),a("code",[s._v("mysql")]),s._v(" 模块并未完全支持 "),a("code",[s._v("MySQL 8")]),s._v(" 的 "),a("code",[s._v("caching_sha2_password")]),s._v(" 加密方式，而 "),a("code",[s._v("caching_sha2_password")]),s._v(" 在"),a("code",[s._v("MySQL 8")]),s._v(" 中是默认的加密方式。因此，下面的方式命令是默认已经使用了 "),a("code",[s._v("caching_sha2_password")]),s._v(" 加密方式，该账号、密码无法在 "),a("code",[s._v("mysql")]),s._v(" 模块中使用。")]),s._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\nQuery OK, 0 rows affected (0.12 sec)\n")])])]),a("h3",{attrs:{id:"解决办法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决办法"}},[s._v("#")]),s._v(" 解决办法")]),s._v(" "),a("p",[s._v("解决方法是从新修改用户"),a("code",[s._v("root")]),s._v("的密码，并指定"),a("code",[s._v("mysql")]),s._v("模块能够支持的加密方式：")]),s._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';\nQuery OK, 0 rows affected (0.12 sec)\n")])])]),a("p",[s._v("通过上述 "),a("code",[s._v("sql")]),s._v(" 语句，我们指定了使用 "),a("code",[s._v("mysql_native_password")]),s._v(" 的加密方式。这种方式是在 "),a("code",[s._v("mysql")]),s._v(" 模块能够支持。")])])}),[],!1,null,null,null);t.default=e.exports}}]);