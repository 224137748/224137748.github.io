<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>密码 | findream</title>
    <meta name="description" content="不积硅步，无以至千里,前端，node.js,webpack,mongodb,express">
    
    
    <link rel="preload" href="/assets/css/0.styles.5c5863ed.css" as="style"><link rel="preload" href="/assets/js/app.173b9c16.js" as="script"><link rel="preload" href="/assets/js/2.4e80b801.js" as="script"><link rel="preload" href="/assets/js/25.8b8fa1ff.js" as="script"><link rel="prefetch" href="/assets/js/10.db2cb67d.js"><link rel="prefetch" href="/assets/js/11.82fa9fe4.js"><link rel="prefetch" href="/assets/js/12.190854a5.js"><link rel="prefetch" href="/assets/js/13.ed43c6a3.js"><link rel="prefetch" href="/assets/js/14.6afa8694.js"><link rel="prefetch" href="/assets/js/15.179b8ce0.js"><link rel="prefetch" href="/assets/js/16.bea1bbd7.js"><link rel="prefetch" href="/assets/js/17.a0d9aa14.js"><link rel="prefetch" href="/assets/js/18.bbcd1f91.js"><link rel="prefetch" href="/assets/js/19.db614af8.js"><link rel="prefetch" href="/assets/js/20.a80ecd6a.js"><link rel="prefetch" href="/assets/js/21.3d2d3713.js"><link rel="prefetch" href="/assets/js/22.4a9a9b95.js"><link rel="prefetch" href="/assets/js/23.cfef4751.js"><link rel="prefetch" href="/assets/js/24.b696d55d.js"><link rel="prefetch" href="/assets/js/26.086abc6d.js"><link rel="prefetch" href="/assets/js/27.72247f39.js"><link rel="prefetch" href="/assets/js/28.5cc3983d.js"><link rel="prefetch" href="/assets/js/29.c6a53f2d.js"><link rel="prefetch" href="/assets/js/3.2980a8e2.js"><link rel="prefetch" href="/assets/js/30.1784b618.js"><link rel="prefetch" href="/assets/js/31.f6553ffd.js"><link rel="prefetch" href="/assets/js/32.838f3dc8.js"><link rel="prefetch" href="/assets/js/33.f9ead0ce.js"><link rel="prefetch" href="/assets/js/34.9a5a8f06.js"><link rel="prefetch" href="/assets/js/35.5d690f27.js"><link rel="prefetch" href="/assets/js/36.885362ff.js"><link rel="prefetch" href="/assets/js/37.8d865559.js"><link rel="prefetch" href="/assets/js/38.4452af43.js"><link rel="prefetch" href="/assets/js/39.e5085be3.js"><link rel="prefetch" href="/assets/js/4.d9d34a91.js"><link rel="prefetch" href="/assets/js/40.f8c18109.js"><link rel="prefetch" href="/assets/js/41.09e6c1a5.js"><link rel="prefetch" href="/assets/js/42.8b661c8a.js"><link rel="prefetch" href="/assets/js/43.eb655c98.js"><link rel="prefetch" href="/assets/js/44.8efd90d3.js"><link rel="prefetch" href="/assets/js/45.97814cde.js"><link rel="prefetch" href="/assets/js/46.a4ec33fb.js"><link rel="prefetch" href="/assets/js/47.8345cdf1.js"><link rel="prefetch" href="/assets/js/48.86f00f5d.js"><link rel="prefetch" href="/assets/js/49.019c6fc7.js"><link rel="prefetch" href="/assets/js/5.9cc7f0fa.js"><link rel="prefetch" href="/assets/js/50.c2d204ff.js"><link rel="prefetch" href="/assets/js/51.44bffdda.js"><link rel="prefetch" href="/assets/js/52.0fc9bc6a.js"><link rel="prefetch" href="/assets/js/53.f600385f.js"><link rel="prefetch" href="/assets/js/54.933ebe6d.js"><link rel="prefetch" href="/assets/js/55.35bfdfa1.js"><link rel="prefetch" href="/assets/js/56.41690f00.js"><link rel="prefetch" href="/assets/js/57.19f3b8ff.js"><link rel="prefetch" href="/assets/js/58.cdf962dc.js"><link rel="prefetch" href="/assets/js/59.5c94183d.js"><link rel="prefetch" href="/assets/js/6.bd40f757.js"><link rel="prefetch" href="/assets/js/60.d32cadbc.js"><link rel="prefetch" href="/assets/js/61.b4a5edd6.js"><link rel="prefetch" href="/assets/js/62.87a09118.js"><link rel="prefetch" href="/assets/js/63.a0292159.js"><link rel="prefetch" href="/assets/js/64.a0c783a5.js"><link rel="prefetch" href="/assets/js/65.fd24ffa7.js"><link rel="prefetch" href="/assets/js/66.3f9f3319.js"><link rel="prefetch" href="/assets/js/67.7609e106.js"><link rel="prefetch" href="/assets/js/68.7c203c83.js"><link rel="prefetch" href="/assets/js/69.7c9e0b59.js"><link rel="prefetch" href="/assets/js/7.34793ec0.js"><link rel="prefetch" href="/assets/js/70.e02e2a22.js"><link rel="prefetch" href="/assets/js/71.00e0ae13.js"><link rel="prefetch" href="/assets/js/72.03b7188c.js"><link rel="prefetch" href="/assets/js/73.8d6ac368.js"><link rel="prefetch" href="/assets/js/74.c3a9a7c3.js"><link rel="prefetch" href="/assets/js/75.95a06956.js"><link rel="prefetch" href="/assets/js/76.e5d629dd.js"><link rel="prefetch" href="/assets/js/77.1a4c4da6.js"><link rel="prefetch" href="/assets/js/78.2ffffe97.js"><link rel="prefetch" href="/assets/js/8.c09fe4d3.js"><link rel="prefetch" href="/assets/js/9.591c91d8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5c5863ed.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/imgs/avatar.jpg" alt="findream" class="logo"> <span class="site-name can-hide">findream</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">概览</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="类别" class="dropdown-title"><span class="title">类别</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/css/" class="nav-link">Css</a></li><li class="dropdown-item"><!----> <a href="/javascript/" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----> <a href="/typescript/" class="nav-link">Typescript·</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">Node.js</a></li><li class="dropdown-item"><!----> <a href="/mongodb/" class="nav-link">Mongodb</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link router-link-active">Mysql</a></li><li class="dropdown-item"><!----> <a href="/cli/" class="nav-link">Cli</a></li></ul></div></div> <a href="https://github.com/224137748/224137748.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">概览</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="类别" class="dropdown-title"><span class="title">类别</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/css/" class="nav-link">Css</a></li><li class="dropdown-item"><!----> <a href="/javascript/" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----> <a href="/typescript/" class="nav-link">Typescript·</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">Node.js</a></li><li class="dropdown-item"><!----> <a href="/mongodb/" class="nav-link">Mongodb</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link router-link-active">Mysql</a></li><li class="dropdown-item"><!----> <a href="/cli/" class="nav-link">Cli</a></li></ul></div></div> <a href="https://github.com/224137748/224137748.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/mysql/" class="sidebar-link">Mysql</a></li><li><a href="/mysql/mysql_01_start.html" class="sidebar-link">起步</a></li><li><a href="/mysql/mysql_02_密码.html" class="active sidebar-link">密码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mysql/mysql_02_密码.html#查询用户密码" class="sidebar-link">查询用户密码</a></li><li class="sidebar-sub-header"><a href="/mysql/mysql_02_密码.html#设置密码" class="sidebar-link">设置密码</a></li><li class="sidebar-sub-header"><a href="/mysql/mysql_02_密码.html#node-js-连接-mysql-密码问题" class="sidebar-link">Node.js 连接 Mysql 密码问题</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="密码"><a href="#密码" class="header-anchor">#</a> 密码</h1> <h2 id="查询用户密码"><a href="#查询用户密码" class="header-anchor">#</a> 查询用户密码</h2> <p>查询用户密码命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token keyword">select</span>  host,  user,  authentication_string  from  mysql.user <span class="token punctuation">;</span>
</code></pre></div><ul><li><p><code>host</code>：允许用户登录的<code>ip</code> '位置'%表示可以远程；</p></li> <li><p><code>user</code>：当前数据库的用户名；</p></li> <li><p><code>authentication_string</code>：用户密码（后面有提到此字段）；</p></li></ul> <h2 id="设置密码"><a href="#设置密码" class="header-anchor">#</a> 设置密码</h2> <p>默认 <code>root</code> 密码为空的话 ，下面使用 <code>navicat</code> 就无法连接 ，所以这里需要修改 <code>root</code> 的密码。</p> <p>此乃关键一步。为此我被坑了好长时间（所以才有了这篇文章），后来尝试了很多才知道在 <code>mysql 5.7.9</code> 以后废弃了 <code>password</code> 字段和 <code>password()</code> 函数；</p> <p><code>authentication_string</code>：字段表示用户密码。</p> <h3 id="操作步骤"><a href="#操作步骤" class="header-anchor">#</a> 操作步骤</h3> <ul><li>1.如果当前 <code>root</code> 用户 <code>authentication_string</code> 字段下有内容，可先将其设置为空，不然直接进行二步骤。</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 密码设置为空</span>
update user <span class="token builtin class-name">set</span> <span class="token assign-left variable">authentication_string</span><span class="token operator">=</span><span class="token string">''</span> where <span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>2.使用 <code>ALTER</code> 修改 <code>root</code> 用户密码, 方法为 <code>ALTER user 'root'@'localhost' IDENTIFIED BY '新密码'</code> 。如下：</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>ALTER <span class="token environment constant">USER</span> <span class="token string">'root'</span>@<span class="token string">'localhost'</span> IDENTIFIED BY <span class="token string">'mypwd#2019'</span><span class="token punctuation">;</span>
</code></pre></div><p>也可输入：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ALTER <span class="token environment constant">USER</span> <span class="token string">'root'</span>@<span class="token string">'localhost'</span> IDENTIFIED WITH mysql_native_password BY <span class="token string">'mypwd#2019'</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">提示</p> <p><code>root@</code> 后面是 <code>user</code> 表的 <code>Host</code> 字段的内容，新安装默认是 <code>localhost</code> , 因为在这增加了远程访问，所以将 <code>localhost</code> 手动改成了 <code>%</code>。</p></div> <p>改完之后可执行：<code>flush privileges;</code> （ 重新加载权限表 ）</p> <div class="language-bash extra-class"><pre class="language-bash"><code>flush privileges<span class="token punctuation">;</span>
</code></pre></div><p><strong>注意：<code>mysql8.0</code> 之后的版本，下面方法已经不适用。切记！！！</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>UPDATE user SET <span class="token assign-left variable">password</span><span class="token operator">=</span>PASSWORD<span class="token punctuation">(</span><span class="token string">&quot;新密码&quot;</span><span class="token punctuation">)</span> WHERE <span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token string">'用户名'</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="node-js-连接-mysql-密码问题"><a href="#node-js-连接-mysql-密码问题" class="header-anchor">#</a> Node.js 连接 Mysql 密码问题</h2> <p>昨天我通过 <code>Node.js</code> 中 <code>mysql</code> 模块连接数据时，控制台一直报错，起初我以为是我代码逻辑有问题，最终定位到只要数据库连接就会报一下错误信息：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Error: ER_NOT_SUPPORTED_AUTH_MODE: Client does not support authentication protocol requested by server<span class="token punctuation">;</span> consider upgrading MySQL client
    at Handshake.Sequence._packetToError <span class="token punctuation">(</span>D:<span class="token punctuation">\</span>workspaceGithub<span class="token punctuation">\</span>nodejs-book-samples<span class="token punctuation">\</span>samples<span class="token punctuation">\</span>mysql-demo<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>mysql<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>protocol<span class="token punctuation">\</span>sequences<span class="token punctuation">\</span>Sequence.js:47:14<span class="token punctuation">)</span>
    at Handshake.ErrorPacket <span class="token punctuation">(</span>D:<span class="token punctuation">\</span>workspaceGithub<span class="token punctuation">\</span>nodejs-book-samples<span class="token punctuation">\</span>samples<span class="token punctuation">\</span>mysql-demo<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>mysql<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>protocol<span class="token punctuation">\</span>sequences<span class="token punctuation">\</span>Handshake.js:123:18<span class="token punctuation">)</span>
    at Protocol._parsePacket <span class="token punctuation">(</span>D:<span class="token punctuation">\</span>workspaceGithub<span class="token punctuation">\</span>nodejs-book-samples<span class="token punctuation">\</span>samples<span class="token punctuation">\</span>mysql-demo<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>mysql<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>protocol<span class="token punctuation">\</span>Protocol.js:291:23<span class="token punctuation">)</span>
    at Parser._parsePacket <span class="token punctuation">(</span>D:<span class="token punctuation">\</span>workspaceGithub<span class="token punctuation">\</span>nodejs-book-samples<span class="token punctuation">\</span>samples<span class="token punctuation">\</span>mysql-demo<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>mysql<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>protocol<span class="token punctuation">\</span>Parser.js:433:10<span class="token punctuation">)</span>
    at Parser.write <span class="token punctuation">(</span>D:<span class="token punctuation">\</span>workspaceGithub<span class="token punctuation">\</span>nodejs-book-samples<span class="token punctuation">\</span>samples<span class="token punctuation">\</span>mysql-demo<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>mysql<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>protocol<span class="token punctuation">\</span>Parser.js:43:10<span class="token punctuation">)</span>
    at Protocol.write <span class="token punctuation">(</span>D:<span class="token punctuation">\</span>workspaceGithub<span class="token punctuation">\</span>nodejs-book-samples<span class="token punctuation">\</span>samples<span class="token punctuation">\</span>mysql-demo<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>mysql<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>protocol<span class="token punctuation">\</span>Protocol.js:38:16<span class="token punctuation">)</span>
    at Socket.<span class="token operator">&lt;</span>anonymous<span class="token operator">&gt;</span> <span class="token punctuation">(</span>D:<span class="token punctuation">\</span>workspaceGithub<span class="token punctuation">\</span>nodejs-book-samples<span class="token punctuation">\</span>samples<span class="token punctuation">\</span>mysql-demo<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>mysql<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>Connection.js:91:28<span class="token punctuation">)</span>
    at Socket.<span class="token operator">&lt;</span>anonymous<span class="token operator">&gt;</span> <span class="token punctuation">(</span>D:<span class="token punctuation">\</span>workspaceGithub<span class="token punctuation">\</span>nodejs-book-samples<span class="token punctuation">\</span>samples<span class="token punctuation">\</span>mysql-demo<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>mysql<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>Connection.js:525:10<span class="token punctuation">)</span>
    at Socket.emit <span class="token punctuation">(</span>events.js:196:13<span class="token punctuation">)</span>
    at addChunk <span class="token punctuation">(</span>_stream_readable.js:290:12<span class="token punctuation">)</span>
    --------------------

</code></pre></div><p>问题描述在这里 <code>Client does not support authentication protocol requested by server; consider upgrading MySQL client at Handshake.Sequence._packetToError</code>，说我的 <code>mysql</code> 客户端版本不支持用户身份验证，但是我安装的客户端是目前比较新的版本，按理说不会不支持呀，带着问题我向度娘寻找答案。</p> <h3 id="出错原因"><a href="#出错原因" class="header-anchor">#</a> 出错原因</h3> <p>原来，最新的 <code>mysql</code> 模块并未完全支持 <code>MySQL 8</code> 的 <code>caching_sha2_password</code> 加密方式，而 <code>caching_sha2_password</code> 在<code>MySQL 8</code> 中是默认的加密方式。因此，下面的方式命令是默认已经使用了 <code>caching_sha2_password</code> 加密方式，该账号、密码无法在 <code>mysql</code> 模块中使用。</p> <div class="language-mysql extra-class"><pre class="language-text"><code>mysql&gt; ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';
Query OK, 0 rows affected (0.12 sec)
</code></pre></div><h3 id="解决办法"><a href="#解决办法" class="header-anchor">#</a> 解决办法</h3> <p>解决方法是从新修改用户<code>root</code>的密码，并指定<code>mysql</code>模块能够支持的加密方式：</p> <div class="language-mysql extra-class"><pre class="language-text"><code>mysql&gt; ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';
Query OK, 0 rows affected (0.12 sec)
</code></pre></div><p>通过上述 <code>sql</code> 语句，我们指定了使用 <code>mysql_native_password</code> 的加密方式。这种方式是在 <code>mysql</code> 模块能够支持。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/224137748/224137748.github.io/edit/document/docs/mysql/mysql_02_密码.md" target="_blank" rel="noopener noreferrer">编辑</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">12/17/2019, 10:16:44 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mysql/mysql_01_start.html" class="prev">起步</a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.173b9c16.js" defer></script><script src="/assets/js/2.4e80b801.js" defer></script><script src="/assets/js/25.8b8fa1ff.js" defer></script>
  </body>
</html>
